{% extends 'main.html' %}
{% block navbar %}
{% endblock %}
{% block content %}
<div class="container-fluid">
    <div class="row flex-nowrap">
        <div class="col-auto siderbar forevents col-md-2 px-sm-1 px-0" style="flex: 0 0 12.5%; max-width: 12.5%;">
            <div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-2 text-white min-vh-100">
                <a href="{% url 'home-admin' %}"
                    class="d-flex align-items-center pb-3 mb-md-0 me-md-auto text-white text-decoration-none">
                    <img class="navbar-brand" style="width:100%" src="{{ MEDIA_URL }}logos/logo.jpg"
                        alt="EventEase Logo">
                </a>
                <ul class="nav nav-pills flex-column text-white mb-sm-auto mb-0 align-items-center align-items-sm-start"
                    id="menu">
                    <li class="nav-item">
                        <a href="{% url 'home-admin' %}" class="nav-link align-middle px-0 text-white">
                            <i class="fs-4 bi-house"></i>
                            <span class="ms-1 d-none d-sm-inline">Home</span>
                        </a>
                    </li>

                    <li>
                        <a href="{% url 'users' %}" class="nav-link px-0 align-middle text-white">
                            <i class="fs-4 bi-people"></i>
                            <span class="ms-1 d-none d-sm-inline">Users</span>
                        </a>
                    </li>

                    <li>
                        <a href="{% url 'admin-events' %}" class="nav-link px-0 align-middle text-white">
                            <i class="fs-4 bi-calendar-event"></i>
                            <span class="ms-1 d-none d-sm-inline">Events</span>
                        </a>
                    </li>
                   

                    <li>
                        <a href="{% url 'admin-locations' %}" class="nav-link px-0 align-middle text-white">
                            <i class="fs-4 bi-geo-alt"></i>
                            <span class="ms-1 d-none d-sm-inline">Locations</span>
                        </a>
                    </li>
                </ul>

                <hr>
                <div class="dropdown pb-4 mt-auto">
                    <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle"
                        id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="{{ request.user.profile_set.first.photo.url }}" alt="hugenerd" width="30" height="30"
                            class="rounded-circle">
                        <span class="d-none d-sm-inline mx-1">{{ request.user.username }}</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-light text-small shadow">
                        <li><a class="dropdown-item" href="{% url 'admin_account_settings' %}">Settings</a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="{% url 'logout' %}">Sign out</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col py-3 events view-">
            <div class="content container-fluid">
               <div class="row">
                  <div class="col-12">
                      <div class="page-title-box d-sm-flex align-items-center justify-content-between bg-galaxy-transparent">
                          <h4 class="mb-sm-0">Users List</h4>

                          <div class="page-title-right">
                              <ol class="breadcrumb m-0">
                                  <li class="breadcrumb-item"><a href="javascript: void(0);">EventEase</a></li>
                                  <li class="breadcrumb-item active">Users List</li>
                              </ol>
                          </div>

                      </div>
                  </div>
              </div>
                <div class="row">
                   <div class="col-sm-6 col-lg-3 mb-3 mb-lg-5">
                      <div class="card h-100">
                         <div class="card-body">
                            <h6 class="card-subtitle mb-2">Total users accepted</h6>
                            <div class="row align-items-center gx-2">
                               <div class="col">
                                  <span class="js-counter display-4 text-dark" data-value="24">{{total_users_accepted}}</span>
                                  <span class="text-body fs-5 ms-1">from {{ total_users }}</span>
                               </div>
                               <div class="col-auto">
                                  <span class="badge bg-soft-success text-success p-1">
                                  <i class="bi-graph-up"></i> 5.0%
                                  </span>
                               </div>
                            </div>
                         </div>
                      </div>
                   </div>
                      <div class="col-sm-6 col-lg-3 mb-3 mb-lg-5">
                      <div class="card h-100">
                         <div class="card-body">
                            <h6 class="card-subtitle mb-2">New users</h6>
                            <div class="row align-items-center gx-2">
                               <div class="col">
                                  <span class="js-counter display-4 text-dark" data-value="24">{{new_this_month}}</span>
                                  <span class="text-body fs-5 ms-1">from {{ total_users }}</span>
                               </div>
                               <div class="col-auto">
                                 {% if percent_new > 0 %}
                                  <span class="badge bg-soft-success text-success p-1">
                                  <i class="bi-graph-up"></i> {{percent_new}}%
                                  </span>
                                 {% else %}
                                 <span class="badge p-1" style=" color: #6c757d;">
    <i class="bi-graph-up"></i> {{ percent_new }}%
</span>

                                  {% endif %}
                               </div>
                            </div>
                         </div>
                      </div>
                   </div>
                </div>
                {% if updated %}
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                  <h4 class="alert-heading">Well done!</h4>
                  <p>You have succesfully updated the user's account.</p>
                  <hr>
                  <p class="mb-0">They will be able to see the new informations and use their accounts right away!</p>
                  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
              {% endif %}
                <div class="card">
                   <div class="table-responsive datatable-custom position-relative">
                      <div id="datatable_wrapper" class="dataTables_wrapper no-footer">
                         <table id="datatable" class="table table-lg table-borderless table-thead-bordered table-nowrap table-align-middle card-table dataTable no-footer" data-hs-datatables-options="{
                            &quot;columnDefs&quot;: [{
                            &quot;targets&quot;: [0, 7],
                            &quot;orderable&quot;: false
                            }],
                            &quot;order&quot;: [],
                            &quot;info&quot;: {
                            &quot;totalQty&quot;: &quot;#datatableWithPaginationInfoTotalQty&quot;
                            },
                            &quot;search&quot;: &quot;#datatableSearch&quot;,
                            &quot;entries&quot;: &quot;#datatableEntries&quot;,
                            &quot;pageLength&quot;: 15,
                            &quot;isResponsive&quot;: false,
                            &quot;isShowPaging&quot;: false,
                            &quot;pagination&quot;: &quot;datatablePagination&quot;
                            }" role="grid" aria-describedby="datatable_info">
                            <thead class="thead-light">
                               <tr role="row">
                                  <th class="table-column-pe-0 sorting_disabled" rowspan="1" colspan="1" aria-label="
                                     " style="width: 44.8281px;">
                                  </th>
                                  <th class="table-column-ps-0 sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Name: activate to sort column ascending" style="width: 279.578px;">Name</th>
                                  <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Country: activate to sort column ascending" style="width: 174.969px;">Country</th>
                                  <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Last_active: activate to sort column ascending" style="width: 151.062px;">Last active</th>
                                  <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Salary: activate to sort column ascending" style="width: 202.469px;">Salary</th>
                                  <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Role: activate to sort column descending" style="width: 114.078px;" aria-sort="ascending">Date Joined</th>
                                  <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" aria-label="Status: activate to sort column ascending" style="width:{% if non_acc %} 300.469px {% else %} 202.469px; {% endif %}">Action</th>
                                  <th class="sorting" rowspan="1" colspan="1" aria-label="" style="width: 133.359px;">Status</th>
                               </tr>
                            </thead>
                            <tbody>
                              {% for profile in non_acc %}
                              
                                 <tr role="row" class="{% if user.id|divisibleby:2 %} even {% else %} odd {% endif %}">
                                    <td class="table-column-pe-0">
                                    </td>
                                    <td class="table-column-ps-0">
                                       <a class="d-flex align-items-center" href="{% url 'view_user_admin' profile.username %}">
                                          <div class="avatar avatar-circle">
                                             {% if profile.photo %}
                                             <img class="avatar-img" style="width: 50px; height: 50px; object-fit: cover; border-radius: 50px;" src="{{ profile.photo.url }}" alt="Image Description">
                                             {% endif %}
                                          </div>
                                          <div class="ms-3">
                                             <span class="d-block h5 text-inherit mb-0">{{ profile.first_name }} {{ profile.last_name }} <i class="bi-patch-check-fill text-primary" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Top endorsed" data-bs-original-title="Top endorsed"></i></span>
                                             <span class="d-block fs-5 text-body">{{ profile.email }}</span>
                                          </div>
                                       </a>
                                    </td>
                                    <td>{{ profile.country }}</td>
                                    <td>
                                       <span class="legend-indicator bg-success"></span>
                                       N/A
                                    </td>
                                    <td>
                                       <div class="d-flex align-items-center">
                                          <span class="fs-5 me-2">
                                           N/A   
                                        </span>
                                       </div>
                                    </td>
                                    <td class="sorting_1">{{ profile.created_at.date }}</td>
                                    <td>
                                       <form action="" method="POST">
                                       <input type="hidden" name="profile_id" value="{{ profile.id }}">
                                       <input type="hidden" name="nr_form" value="form_3">
                                       {% csrf_token %}
                                     <button type="button" class="btn btn-white btn-sm" data-bs-toggle="modal" data-bs-target="#viewUserModal"
                                     data-id ="{{ profile.id }}"
                                     data-username="{{ profile.username }}"
                                     data-first-name="{{ profile.first_name }}"
                                     data-last-name="{{ profile.last_name }}"
                                     data-email="{{ profile.email }}"
                                     data-number="{{ profile.number }}"
                                     {% if profile.photo %}
                                     data-photo="{{ profile.photo.url }}"
                                     {% endif %}
                                     {% if profile.cv_file %}
                                     data-cv="{{ profile.cv_file.url }}"
                                     {% endif %}
                                     data-description="{{ profile.description }}">
                                     <i class="bi-pencil-fill me-1"></i> View
                                 </button>
                                 <button type="submit" name="action" value="accept" class="btn btn-white btn-sm">
                                    <i class="bi bi-check-circle"></i> Accept
                                </button>
                                <button type="submit" name="action" value="reject" class="btn btn-white btn-sm">
                                 <i class="bi bi-x-circle-fill"></i> Reject
                             </button>
                                 </form>
                                    </td>
                                    <td>
                                       <span class="sorting_1"></span>
                                       Not Accepted
                                    </td>
                                 </tr>
                             {% endfor %}
                               {% for user in users %}
                               <tr role="row" class="{% if user.id|divisibleby:2 %} even {% else %} odd {% endif %}">
                                 <td class="table-column-pe-0">
                                 </td>
                                 <td class="table-column-ps-0">
                                    <a class="d-flex align-items-center" href="{% url 'view_user_admin' user.username %}">
                                       <div class="avatar avatar-circle">
                                          {% if user.profile_set.first.photo %}
                                          <img class="avatar-img" style="width: 50px; height: 50px; object-fit: cover; border-radius: 50px;" src="{{ user.profile_set.first.photo.url }}" alt="Image ">
                                          {%endif%}
                                       </div>
                                       <div class="ms-3">
                                          <span class="d-block h5 text-inherit mb-0">{{ user.first_name }} {{ user.last_name }} <i class="bi-patch-check-fill text-primary" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Top endorsed" data-bs-original-title="Top endorsed"></i></span>
                                          <span class="d-block fs-5 text-body">{{ user.email }}</span>
                                       </div>
                                    </a>
                                 </td>
                                 <td>{{ user.profile_set.first.country }}</td>
                                 <td>
                                    <span class="legend-indicator bg-success"></span>
                                    {{ user.last_login }}
                                 </td>
                                 <td>
                                    <div class="d-flex align-items-center">
                                       <span class="fs-5 me-2">{% for item in user_data %}
                                          {% if item.username == user.username %}
                                                  {{ item.salary }} $
                                          {% endif %}
                                      {% endfor %}</span>
                                       <div class="progress table-progress">
                                          <div class="progress-bar" role="progressbar" style="width: 72%" aria-valuenow="72" aria-valuemin="0" aria-valuemax="100"></div>
                                       </div>
                                    </div>
                                 </td>
                                 <td class="sorting_1">{{ user.date_joined.date }}</td>
                                 <td>
                                    <button type="button" class="btn btn-white btn-sm" data-bs-toggle="modal" data-bs-target="#editUserModal"
                                    data-id ="{{ user.id }}"
                                    data-username="{{ user.username }}"
                                    data-first-name="{{ user.first_name }}"
                                    data-last-name="{{ user.last_name }}"
                                    data-email="{{ user.email }}"
                                    data-number="{{ user.profile_set.first.number }}"
                                    {% if user.profile_set.first.photo %}
                                    data-photo="{{ user.profile_set.first.photo.url }}"
                                    {% endif %}>
                                    <i class="bi-pencil-fill me-1"></i> Edit
                                 </button>
                                 <button type="button" class="btn btn-white btn-sm"
                                  data-bs-toggle="modal"
                                   data-bs-target="#DeleteUserModal"
                                    data-id ="{{ user.id }}">
                                    <i class="bi bi-trash me-1"></i> Delete
                                 </button>
                                 </td>
                                 <td>
                                    <span class="sorting_1"></span>
                                    Accepted
                                 </td>
                              </tr>
                              {% endfor %}
                            </tbody>
                         </table>
                      </div>
                   </div>
                </div>
             </div>
             <div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel" style="display: none;" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-lg">
                   <div class="modal-content">
                      <div class="modal-header">
                         <h5 class="modal-title" id="editUserModalLabel">Edit user</h5>
                         <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                         <div class="js-nav-scroller hs-nav-scroller-horizontal">
                            <span class="hs-nav-scroller-arrow-prev" style="display: none;">
                            <a class="hs-nav-scroller-arrow-link" href="javascript:;">
                            <i class="bi-chevron-left"></i>
                            </a>
                            </span>
                            <span class="hs-nav-scroller-arrow-next" style="display: none;">
                            <a class="hs-nav-scroller-arrow-link" href="javascript:;">
                            <i class="bi-chevron-right"></i>
                            </a>
                            </span>
                            <ul class="js-tabs-to-dropdown nav nav-segment nav-fill mb-5" id="editUserModalTab" role="tablist">
                               <li class="nav-item" role="presentation">
                                  <a class="nav-link active" href="#profile" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" role="tab" aria-selected="true">
                                  <i class="bi-person me-1"></i> Profile
                                  </a>
                               </li>
                               <li class="nav-item" role="presentation">
                                  <a class="nav-link" href="#change-password" id="change-password-tab" data-bs-toggle="tab" data-bs-target="#change-password" role="tab" aria-selected="false" tabindex="-1">
                                  <i class="bi-shield-lock me-1"></i> Change password
                                  </a>
                               </li>
                            </ul>
                         </div>
                         <div class="tab-content" id="editUserModalTabContent">
                            <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                               <form method="POST" action="" enctype="multipart/form-data">
                                 {% csrf_token %}
                                 <input type="hidden" name="user_id" id="user_id_1">
                                 <input type="hidden" value="form_1" name="nr_form">
                                  <div class="profile-cover">
                                     <div class="profile-cover-img-wrapper">
                                        <img id="editProfileCoverImgModal" class="img-fluid" style="height:320px; width: 100%;" src="{{ MEDIA_URL }}logos/Login Picture.jpg" alt="Image Description">
                                     </div>
                                  </div>
                                  <div style="position: relative; height: 100px; text-align: center;">
                                    <label class="avatar avatar-xxl avatar-circle avatar-uploader profile-cover-avatar" style="
                                      position: absolute; 
                                      top: 50%; 
                                      left: 50%; 
                                      transform: translate(-50%, -80%);
                                      margin-top: -50px;" for="editAvatarUploaderModal">
                                      <img id="editAvatarImgModal" class="rounded-circle mx-auto d-block" 
                                           style="width: 150px !important;
                                           height:150px; 
                                           border: 5px solid #fff;" 
                                           src="" alt="Image Description">
                                      
                                           <input type="file" style="display: none;" class="js-file-attach avatar-uploader-input" id="editAvatarUploaderModal" 
                                           data-hs-file-attach-options="{
                                             &quot;textTarget&quot;: &quot;#editAvatarImgModal&quot;,
                                             &quot;mode&quot;: &quot;image&quot;,
                                             &quot;targetAttr&quot;: &quot;src&quot;,
                                             &quot;allowTypes&quot;: [&quot;.png&quot;, &quot;.jpeg&quot;, &quot;.jpg&quot;]
                                           }"
                                           accept="image/png, image/jpeg"
                                           onchange="updateImage(event)"
                                           name="profile_picture"
                                           >
                                    
                                      <span class="avatar-uploader-trigger" 
                                            style="
                                              display: inline-flex; 
                                              justify-content: center; 
                                              align-items: center; 
                                              width: 40px; 
                                              height: 40px; 
                                              border-radius: 50%; 
                                              background-color: #fff; 
                                              position: absolute; 
                                              bottom: -10px; 
                                              top:90px;
                                              right: 5px;">
                                        <i class="bi-pencil-fill avatar-uploader-icon shadow-sm"></i>
                                      </span>
                                    </label>
                                  </div>
                                  <div class="row mb-4">
                                     <label for="editFirstNameModalLabel" class="col-sm-3 col-form-label form-label">Full name <i class="tio-help-outlined text-body ms-1" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Displayed on public forums, such as Front." data-bs-original-title="Displayed on public forums, such as Front."></i></label>
                                     <div class="col-sm-9">
                                        <div class="input-group input-group-sm-vertical">
                                           <input type="text" class="form-control" name="editFirstNameModal" id="editFirstNameModalLabel" placeholder="Your first name" aria-label="Your first name" value="">
                                           <input type="text" class="form-control" name="editLastNameModal" id="editLastNameModalLabel" placeholder="Your last name" aria-label="Your last name" value="">
                                        </div>
                                     </div>
                                  </div>
                                  <div class="row mb-4">
                                     <label for="editEmailModalLabel" class="col-sm-3 col-form-label form-label">Email</label>
                                     <div class="col-sm-9">
                                        <input type="email" class="form-control" name="editEmailModal" id="editEmailModalLabel" placeholder="Email" aria-label="Email" >
                                     </div>
                                  </div>
                                  <div class="row mb-4">
                                    <label for="editUsernameModal" class="col-sm-3 col-form-label form-label">Username</label>
                                    <div class="col-sm-9">
                                       <input type="text" class="form-control" name="editUsernameModal" id="editUsernameModal" placeholder="Username" aria-label="Username">
                                    </div>
                                 </div>
                                  <div class="row mb-4">
                                     <label for="editPhoneLabel" class="col-sm-3 col-form-label form-label">Phone </label>
                                     <div class="col-sm-9">
                                        <div class="input-group input-group-sm-vertical">
                                           <input type="text" class="js-masked-input form-control" name="phone" id="editPhoneLabel" placeholder="+x(xxx)xxx-xx-xx" aria-label="+x(xxx)xxx-xx-xx"  data-hs-mask-options="{
                                              &quot;template&quot;: &quot;+0(000)000-00-00&quot;
                                              }">
                                        </div>
                                     </div>
                                  </div>
                                  <div class="d-flex justify-content-end">
                                     <div class="d-flex gap-3">
                                        <button type="button" class="btn btn-white" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
                                        <button type="submit" class="btn btn-primary">Save changes</button>
                                     </div>
                                  </div>
                               </form>
                            </div>
                            <div class="tab-pane fade" id="change-password" role="tabpanel" aria-labelledby="change-password-tab">
                              {% if error_pas %}
                              <div class="alert alert-warning alert-dismissible fade show" role="alert">
                                 <strong>Incorrect parameters! </strong> Please type the correct password or check for spelling.
                                 <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                              </div>
                              {% endif %}
                              
                              <form method="POST" action="">
                                 <input type="hidden" name="user_id" id="user_id_2">
                                 {% csrf_token %}
                                 <input type="hidden" name="nr_form" value="form_2">
                                 <div class="row mb-4">
                                    <label for="editUserModalCurrentPasswordLabel" class="col-sm-3 col-form-label form-label">
                                        Current password
                                    </label>
                                    <div class="col-sm-9">
                                        <div class="input-group input-group-merge">
                                            <input required type="password" class="form-control" 
                                                   name="currentPassword" id="editUserModalCurrentPasswordLabel"
                                                   placeholder="Enter current password" 
                                                   aria-label="Enter current password">
                                            
                                            <button type="button" class="input-group-text" 
                                                    id="togglePassword">
                                                <i id="togglePasswordIcon" class="bi bi-eye-slash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <script>
                                    document.getElementById("togglePassword").addEventListener("click", function() {
                                        var passwordField = document.getElementById("editUserModalCurrentPasswordLabel");
                                        var icon = document.getElementById("togglePasswordIcon");
                                
                                        if (passwordField.type === "password") {
                                            passwordField.type = "text";
                                            icon.classList.remove("bi-eye-slash");
                                            icon.classList.add("bi-eye");
                                        } else {
                                            passwordField.type = "password";
                                            icon.classList.remove("bi-eye");
                                            icon.classList.add("bi-eye-slash");
                                        }
                                    });
                                </script>
                                
                                 <div class="row mb-4">
                                    <label for="editUserModalNewPassword" class="col-sm-3 col-form-label form-label">New password</label>
                                    <div class="col-sm-9">
                                       <input required type="password" class="js-toggle-password form-control" name="editUserModalNewPassword" id="editUserModalNewPassword" placeholder="Enter new password" aria-label="Enter new password" data-hs-toggle-password-options="{
                                          &quot;target&quot;: &quot;#editUserModalChangePassModalCheckbox&quot;
                                          }">
                                    </div>
                                 </div>
                                 <div class="row mb-4">
                                    <label for="editUserModalConfirmNewPasswordLabel" class="col-sm-3 col-form-label form-label">Confirm new password</label>
                                    <div class="col-sm-9">
                                       <input type="password" class="js-toggle-password form-control" name="confirmNewPassword" id="editUserModalConfirmNewPasswordLabel" placeholder="Confirm your new password" aria-label="Confirm your new password" data-hs-toggle-password-options="{
                                          &quot;target&quot;: &quot;#editUserModalChangePassModalCheckbox&quot;
                                          }">
                                    </div>
                                 </div>
                                 <div class="d-flex justify-content-end">
                                    <div class="d-flex gap-3">
                                       <button type="button" class="btn btn-white" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
                                       <button type="submit" class="btn btn-primary">Save changes</button>
                                    </div>
                                 </div>
                              </form>
                           </div>
                            
                         </div>
                      </div>
                   </div>
                </div>
             </div>


             <div class="modal fade" id="viewUserModal" tabindex="-1" aria-labelledby="viewUserModalLabel" style="display: none;" aria-hidden="true">
               <div class="modal-dialog modal-dialog-centered modal-lg">
                  <div class="modal-content">
                     <div class="modal-header">
                        <h5 class="modal-title" id="editUserModalLabel">View new user</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                     </div>
                     <div class="modal-body">
                        <div class="js-nav-scroller hs-nav-scroller-horizontal">
                           <span class="hs-nav-scroller-arrow-prev" style="display: none;">
                           <a class="hs-nav-scroller-arrow-link" href="javascript:;">
                           <i class="bi-chevron-left"></i>
                           </a>
                           </span>
                           <span class="hs-nav-scroller-arrow-next" style="display: none;">
                           <a class="hs-nav-scroller-arrow-link" href="javascript:;">
                           <i class="bi-chevron-right"></i>
                           </a>
                           </span>
                           <ul class="js-tabs-to-dropdown nav nav-segment nav-fill mb-5" id="ViewUserModalTab" role="tablist">
                              <li class="nav-item" role="presentation">
                                 <a class="nav-link active" href="#profile" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" role="tab" aria-selected="true">
                                 <i class="bi-person me-1"></i> Profile
                                 </a>
                              </li>
                           </ul>
                        </div>
                        <div class="tab-content" id="editUserModalTabContent">
                           <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                              <div class="profile-cover">
                                 <div class="profile-cover-img-wrapper">
                                    <img id="editProfileCoverImgModal" class="img-fluid" style="height:320px; width: 100%;" src="{{ MEDIA_URL }}logos/Login Picture.jpg" alt="Image Description">
                                 </div>
                              </div>
                              <div style="position: relative; height: 100px; text-align: center;">
                                 <label class="avatar avatar-xxl avatar-circle avatar-uploader profile-cover-avatar" style="
                                    position: absolute; 
                                    top: 50%; 
                                    left: 50%; 
                                    transform: translate(-50%, -80%);
                                    margin-top: -50px;" for="editAvatarUploaderModal">
                                    <img id="editAvatarImgModalView" class="rounded-circle mx-auto d-block" 
                                         style="width: 150px !important; height:150px; border: 5px solid #fff;" 
                                         src="" alt="Image Description" aria-disabled="true" aria-readonly="true">
                                 </label>
                              </div>
                              <div class="row mb-4">
                                 <label for="editFirstNameModalLabel" class="col-sm-3 col-form-label form-label">Full name</label>
                                 <div class="col-sm-9">
                                    <div class="input-group input-group-sm-vertical">
                                       <input type="text" class="form-control" name="editFirstNameModal" id="editFirstNameModalLabel" placeholder="Your first name" aria-label="Your first name" value="" readonly>
                                       <input type="text" class="form-control" name="editLastNameModal" id="editLastNameModalLabel" placeholder="Your last name" aria-label="Your last name" value="" readonly>
                                    </div>
                                 </div>
                              </div>
                              <div class="row mb-4">
                                 <label for="editEmailModalLabel" class="col-sm-3 col-form-label form-label">Email</label>
                                 <div class="col-sm-9">
                                    <input type="email" class="form-control" name="editEmailModal" id="editEmailModalLabel" placeholder="Email" aria-label="Email" readonly>
                                 </div>
                              </div>
                              <div class="row mb-4">
                                 <label for="editUsernameModal" class="col-sm-3 col-form-label form-label">Username</label>
                                 <div class="col-sm-9">
                                    <input type="text" class="form-control" name="editUsernameModal" id="editUsernameModal" placeholder="Username" aria-label="Username" readonly>
                                 </div>
                              </div>
                              <div class="row mb-4">
                                 <label for="editPhoneLabel" class="col-sm-3 col-form-label form-label">Phone:</label>
                                 <div class="col-sm-9">
                                    <div class="input-group input-group-sm-vertical">
                                       <input type="text" class="js-masked-input form-control" name="phone" id="editPhoneLabel" placeholder="+x(xxx)xxx-xx-xx" aria-label="+x(xxx)xxx-xx-xx"  data-hs-mask-options="{
                                          &quot;template&quot;: &quot;+0(000)000-00-00&quot;
                                          }" readonly>
                                    </div>
                                 </div>
                              </div>
                              <div class="row mb-4">
                                 <label for="editDescriptionModal" class="col-sm-3 col-form-label form-label">Description:</label>
                                 <div class="col-sm-9">
                                    <textarea style="height: auto;" readonly class="form-control" name="editDescriptionModal" id="editDescriptionModal" placeholder="Description" aria-label="Description"></textarea>
                                 </div>
                              </div>
                              <div class="row mb-4">
                                 <label for="cvLink" class="col-sm-3 col-form-label form-label">CV file:</label>
                                    <div class="col-sm-9">
                                       <a id="cvLink" href="#" target="_blank" class="btn btn-outline-warning btn-sm mt-2">View CV</a>
                                    </div>
                              </div>
                              <div class="d-flex justify-content-end">
                                 <div class="d-flex gap-3">
                                    <button type="button" class="btn btn-white" data-bs-dismiss="modal" aria-label="Close">Exit</button>
                                 </div>
                              </div>
                           </div>
                        </div>
                        
                     </div>
                  </div>
               </div>
            </div>
        </div>
    </div>
        <div class="modal fade flip" id="DeleteUserModal" tabindex="-1" aria-hidden="true">
                              <form method="POST" action="">
                                 {% csrf_token %}
                                 <input type="hidden" name="nr_form" value="form_4">
                                 <input type="hidden" name="user_id" id="user_id_3">

                                   <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-body p-5 text-center">
                                            <lord-icon src="https://cdn.lordicon.com/gsqxdxog.json" trigger="loop"
                                                colors="primary:#405189,secondary:#f06548"
                                                style="width:90px;height:90px"></lord-icon>
                                            <div class="mt-4 text-center">
                                                <h4>You are about to delete an user</h4>
                                                <p class="text-muted fs-15 mb-4">Deleting an user will remove all of
                                                    it's information from your database.</p>
                                                <div class="hstack gap-2 justify-content-center remove">
                                                    <button
                                                        class="btn btn-link link-success fw-medium text-decoration-none"
                                                        id="deleteRecord-close" data-bs-dismiss="modal"><i
                                                            class="ri-close-line me-1 align-middle"></i> Close</button>
                                                    <button type="submit" class="btn btn-danger" id="delete-record">Yes, Delete
                                                        It</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                              </form>
                            </div>
</div>

<script>
   $('#DeleteUserModal').on('show.bs.modal', function (event) {
    const button = event.relatedTarget; 
    const userId = button.dataset.id; 

    document.querySelector('#DeleteUserModal #user_id_3').value = userId;
});
$('#editUserModal').on('show.bs.modal', function (event) {
    const button = event.relatedTarget;

    const username = button.dataset.username;
    const id = button.dataset.id;
    const firstName = button.dataset.firstName;
    const lastName = button.dataset.lastName;
    const email = button.dataset.email;
    const number = button.dataset.number;
    const photo = button.dataset.photo;


    document.querySelector('#editUserModal #user_id_1').value = id;
    document.querySelector('#editUserModal #user_id_2').value = id;
    document.querySelector('#editUserModal #editAvatarImgModal').src = photo;
    document.querySelector('#editUserModal #editFirstNameModalLabel').value = firstName;
    document.querySelector('#editUserModal #editLastNameModalLabel').value = lastName;  
    document.querySelector('#editUserModal #editUsernameModal').value =username;  
    document.querySelector('#editUserModal #editEmailModalLabel').value = email;
    document.querySelector('#editUserModal #editPhoneLabel').value = number;
});


$('#viewUserModal').on('show.bs.modal', function (event) {
    const button = event.relatedTarget;
    const description = button.dataset.description;
    const username = button.dataset.username;
    const id = button.dataset.id;
    const firstName = button.dataset.firstName;
    const lastName = button.dataset.lastName;
    const email = button.dataset.email;
    const number = button.dataset.number;
    const photo = button.dataset.photo;
    let cv = button.getAttribute('data-cv');
    document.querySelector('#viewUserModal #cvLink').href = cv;


    document.querySelector('#viewUserModal #editAvatarImgModalView').src = photo;
    document.querySelector('#viewUserModal #editFirstNameModalLabel').value = firstName;
    document.querySelector('#viewUserModal #editLastNameModalLabel').value = lastName;  
    document.querySelector('#viewUserModal #editUsernameModal').value =username;  
    document.querySelector('#viewUserModal #editDescriptionModal').value =description;  
    document.querySelector('#viewUserModal #editEmailModalLabel').value = email;
    document.querySelector('#viewUserModal #editPhoneLabel').value = number;
});

</script>
<style>
   .dataTables_length{
      margin-left:85%;
      margin-top:1vw;
   }
   .dataTables_filter{
      margin-right:80%;
      margin-top:-2vw ;
   }
</style>
<script>
    $(document).ready(function () {
    $('#datatable').DataTable();
});

</script>
<script>
   function updateImage(event) {
       const file = event.target.files[0];
       const reader = new FileReader();

       reader.onload = function (e) {
           document.getElementById('editAvatarImgModal').src = e.target.result;
       }

       if (file) {
           reader.readAsDataURL(file); 
       }
   }
</script>

{% endblock %}