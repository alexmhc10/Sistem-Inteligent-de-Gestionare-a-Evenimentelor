{% extends 'main.html' %}

{% block content %}
<style>
    :root {
        --primary-dark: #002B5B;
        --primary-gold: #D4AF37;
        --background-light: #FAF9F6;
        --neutral-gray: #ECECEC;
    }

    .button {
        --border_radius: 9999px;
        --transtion: 0.3s ease-in-out;
        --offset: 2px;

        cursor: pointer;
        position: relative;
        margin: 2rem auto;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        padding: 1.5rem 3rem;
        background-color: transparent;
        border: none;
        border-radius: var(--border_radius);
        transform: scale(calc(1 + (var(--active, 0) * 0.1)));
        transition: transform var(--transtion);
    }

    .button::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        height: 100%;
        background-color: var(--primary-dark);
        border-radius: var(--border_radius);
        box-shadow: inset 0 0.5px var(--neutral-gray), 
                    inset 0 -1px 2px 0 rgba(0,0,0,0.2),
                    0px 4px 10px -4px hsla(0 0% 0% / calc(1 - var(--active, 0))),
                    0 0 0 calc(var(--active, 0) * 0.375rem) var(--primary-gold);
        transition: all var(--transtion);
        z-index: 0;
    }

    .button::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        height: 100%;
        background-color: var(--primary-gold);
        background-image: radial-gradient(
            at 51% 89%,
            hsl(45, 100%, 75%) 0px,
            transparent 50%
        ),
        radial-gradient(at 100% 100%, hsl(45, 100%, 60%) 0px, transparent 50%),
        radial-gradient(at 22% 91%, hsl(45, 100%, 60%) 0px, transparent 50%);
        opacity: var(--active, 0);
        border-radius: var(--border_radius);
        transition: opacity var(--transtion);
        z-index: 2;
    }

    .button:is(:hover, :focus-visible) {
        --active: 1;
    }

    .button:active {
        transform: scale(1);
    }

    .button .dots_border {
        --size_border: calc(100% + 2px);
        overflow: hidden;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: var(--size_border);
        height: var(--size_border);
        background-color: transparent;
        border-radius: var(--border_radius);
        z-index: -10;
    }

    .button .dots_border::before {
        content: "";
        position: absolute;
        top: 30%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        height: 2rem;
        background-color: white;
        mask: linear-gradient(transparent 0%, white 120%);
        animation: rotate 2s linear infinite;
    }

    @keyframes rotate {
        to { transform: rotate(360deg); }
    }

    .button .sparkle {
        position: relative;
        z-index: 10;
        width: 1.75rem;
    }

    .button .sparkle .path {
        fill: currentColor;
        stroke: currentColor;
        transform-origin: center;
        color: var(--neutral-gray);
        transition: color 0.3s ease;
    }

    .button:hover .sparkle .path {
        color: var(--primary-dark);
    }

    .button .text_button {
        position: relative;
        z-index: 10;
        background-image: linear-gradient(
            90deg,
            var(--neutral-gray) 0%,
            hsla(0 0% 100% / var(--active, 0)) 120%
        );
        background-clip: text;
        font-size: 1.5rem;
        font-weight: 600;
        color: transparent;
    }

    /* Stilurile existente pentru restul componente»õilor */
    .flip-card {
        background-color: transparent;
        width: 100%;
        height: 100%;
        perspective: 1000px;
    }

    .flip-card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.8s;
        transform-style: preserve-3d;
    }

    .flip-card:hover .flip-card-inner {
        transform: rotateY(180deg);
    }

    .flip-card-front, .flip-card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 8px;
        overflow: hidden;
    }

    .flip-card-front {
        z-index: 2;
    }

    .flip-card-back {
        transform: rotateY(180deg);
    }

    .dashboard-row {
        display: flex;
        flex-wrap: wrap;
        align-items: stretch;
    }

    .dashboard-row > div {
        display: flex;
        flex-direction: column;
    }

    .full-height-card {
        flex-grow: 1;
        height: 100%;
    }

    .create-event-wrapper {
        display: flex;
        justify-content: center;
        width: 100%;
        padding: 2rem 0;
    }
</style>

<div class="container-fluid mt-4 px-3">
    <h1 class="mb-4 text-center" style="color: var(--primary-dark);">Organizer Dashboard</h1>

    <div class="row dashboard-row">
        <!-- profile -->
        <div class="col-md-3 mb-3">
            <div class="flip-card full-height-card">
                <div class="flip-card-inner">
                    <div class="flip-card-front card d-flex justify-content-center align-items-center text-center" 
                         style="background-color: var(--neutral-gray); color: var(--primary-dark); border-radius: 8px;">
                        <div class="card-body">
                            {% if request.user.profile_set.first.photo %}
                            <img src="{{ request.user.profile_set.first.photo.url }}" alt="Profile Picture"
                                 class="img-fluid rounded-circle mb-3"
                                 style="width: 200px; height: 200px; object-fit: cover;">
                            {% else %}
                            <img src="" alt="default pic" class="img-fluid rounded-circle mb-3">
                            {% endif %}
                            <h5 class="card-title">Your Profile</h5>
                            <p><strong>Name:</strong> {{ request.user.first_name }} {{ request.user.last_name }}</p>
                            <p><strong>Email:</strong> {{ request.user.email }}</p>
                            <p><strong>Events Organized:</strong> 15</p>
                            <p><strong>Location:</strong> {{ request.user.profile_set.first.location }}</p>
                        </div>
                    </div>

                    <div class="flip-card-back card" style="background-color: var(--primary-gold); color: white; border-radius: 8px;">
                        <div class="card-body d-flex flex-column justify-content-center align-items-center text-center">
                            <h5 class="card-title">Statistici rapide</h5>
                            <p>‚≠ê Rating mediu: 4.8</p>
                            <p>üìç Evenimente √Æn 3 ora»ôe</p>
                            <p>üìÖ Ultimul eveniment: 10.04.2025</p>
                            <p>üí¨ Feedback pozitiv: 95%</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- upcoming events -->
        <div class="col-md-6 mb-3">
            <div class="card full-height-card" style="background-color: var(--background-light); color: var(--primary-dark); border-radius: 8px;">
                <div class="card-body">
                    <h5 class="card-title">Upcoming Events</h5>
                    <table class="table table-striped" style="border-radius: 8px; border-color: var(--neutral-gray);">
                        <thead>
                            <tr style="background-color: var(--neutral-gray);">
                                <th style="color: var(--primary-dark);">Name</th>
                                <th style="color: var(--primary-dark);">Date</th>
                                <th style="color: var(--primary-dark);">Location</th>
                                <th style="color: var(--primary-dark);">Participants</th>
                                <th style="color: var(--primary-dark);">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for event in upcoming_events %}
                            <tr>
                                <td>{{ event.event_name }}</td>
                                <td>{{ event.event_date }}</td>
                                <td>{{ event.location }}</td>
                                <td>{{ event.guests.count }}</td>
                                <td>
                                    <a href="{% url 'event_details' event.id %}" class="btn"
                                       style="background-color: var(--primary-gold); color: var(--background-light); border-radius: 5px;">Details</a>
                                    <a href="{% url 'edit_event' event.id %}" class="btn"
                                       style="background-color: var(--primary-gold); color: var(--background-light); border-radius: 5px;">Edit</a>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="5" class="text-center">No upcoming events</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- stats -->
        <div class="col-md-3 mb-3">
            <div class="d-flex flex-column justify-content-between full-height-card">
                <div class="card" style="background-color: var(--primary-gold); color: var(--background-light); border-radius: 8px;">
                    <div class="card-body">
                        <h5 class="card-title">Organized Events</h5>
                        <p class="card-text display-4">{{ total_events }}</p>
                    </div>
                </div>
                <div class="card mt-3" style="background-color: var(--primary-gold); color: var(--background-light); border-radius: 8px;">
                    <div class="card-body">
                        <h5 class="card-title">Registered Participants</h5>
                        <p class="card-text display-4">{{ total_participants }}</p>
                    </div>
                </div>
                <div class="card mt-3" style="background-color: var(--neutral-gray); color: var(--primary-dark); border-radius: 8px;">
                    <div class="card-body">
                        <h5 class="card-title">Acceptance Rate</h5>
                        <p class="card-text display-4">{{ acceptance_rate }}%</p>
                    </div>
                </div>
                <div class="card mt-3" style="background-color: var(--background-light); color: var(--primary-gold); border-radius: 8px;">
                    <div class="card-body">
                        <h5 class="card-title">Average Feedback</h5>
                        <p class="card-text display-4">{{ average_feedback }} ‚≠ê</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- create-->
    <div class="create-event-wrapper" style="margin-top: -70px; margin-bottom: 20px;">
        <a href="{% url 'event_builder' %}" class="button">
            <div class="dots_border"></div>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="sparkle">
                <path class="path" stroke-linejoin="round" stroke-linecap="round" stroke="currentColor" fill="currentColor" d="M14.187..."></path>
                <path class="path" stroke-linejoin="round" stroke-linecap="round" stroke="currentColor" fill="currentColor" d="M6..."></path>
                <path class="path" stroke-linejoin="round" stroke-linecap="round" stroke="currentColor" fill="currentColor" d="M6.5..."></path>
            </svg>
            <span class="text_button">Create a New Event</span>
        </a>
    </div>

</div>
{% endblock %}