{% extends 'main.html' %}
{% block navbar %}
{% endblock %}

{% load static %}
{% block content %}

<div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
data-sidebar-position="fixed" data-header-position="fixed">

  <!--Sidebar-->
  {% include 'sidebar.html' %}

  <div class="body-wrapper">

    <!--  Header -->
    {% include 'header.html' %}

    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title d-flex align-items-center gap-2 mb-4">
                            Event Overview
                            <span>
                                <iconify-icon icon="solar:question-circle-bold" class="fs-7 d-flex text-muted" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="tooltip-success" data-bs-title="Traffic Overview"></iconify-icon>
                            </span>
                        </h5>
                        <div id="traffic-overview" >
                        </div>
                    </div>
                </div>
            </div>
        <div class="col-lg-4">
          <div class="card">
            <div class="card-body text-center">
              <i class="bi bi-camera h1 text-primary"></i>
              <h4 class="mt-7">Event gallery upload!</h4>
              <p class="card-subtitle mt-2 mb-3">Here you can upload the photos taken at your location and share them with the rest of the guests.</p>
                <button class="btn btn-primary mb-3">Upload</button>
            </div>
          </div>
        </div>
        <div class="col-lg-8">
           <div class="card">
                    <div class="card-body">
                        <div class="header d-flex flex-row justify-content-between">
                          <h5 class="card-title">Guest list</h5>
                          <form action="" class="d-flex flex-row">
                            <input type="text" class="form-control me-2" name="searchGuest" id="" placeholder="Guest name">
                            <button class="btn btn-primary" type="submit">Search</button>
                          </form>
                        </div>
                        <div class="table-responsive">
                            <table class="table text-nowrap align-middle mb-0">
                            <thead>
                                <tr class="border-2 border-bottom border-primary justify-content-center border-0">
                                    <th scope="col" class="ps-0 text-center">Id</th>
                                    <th scope="col" class="text-center">Photo</th>
                                    <th scope="col" class="ps-0 text-center">Full name</th>
                                    <th scope="col" class="text-center">Status</th>
                                    <th scope="col" class="text-center">Arriving time</th>
                                    <th scope="col" class="text-center">Gender</th>
                                    <th scope="col" class="text-center">Cuisine preference</th>
                                    <th scope="col" class="text-center">Vegan</th>
                                    <th scope="col" class="text-center">Allergens</th>
                                    <th scope="col" class="text-center">Table no.</th>
                                </tr>
                            </thead>
                            <tbody class="table-group-divider">
                                {% for response in rspv %}
                                <tr>
                                    <td class="ps-0 fw-medium"><span>{{ forloop.counter }}.</span></td>
                                    <td class="text-center fw-medium"><img src="{{MEDIA_URL}}{{ response.guest.profile_set.all.0.photo }}" class="rounded-circle" width="35" height="35"></td>
                                    <td><span>{{ response.guest.profile_set.all.0.first_name }}</span></td>
                                    <td class="text-center fw-medium"><span class="badge bg-success-subtle text-success text-uppercase">Confirmed</span></td>
                                    <td class="text-center fw-medium">22:31</td>
                                    <td class="text-center fw-medium">{{ response.guest.profile_set.all.0.guest_profile.gender }}</td>
                                    <td class="text-center fw-medium">{{ response.guest.profile_set.all.0.guest_profile.cuisine_preference }}</td>
                                    {% if response.guest.profile_set.all.0.guest_profile.vegan %}
                                    <td class="text-center fw-medium">Yes</td>
                                    {% else %}
                                    <td class="text-center fw-medium">No</td>
                                    {% endif %}
                                    <td class="text-center fw-medium">{{ response.guest.profile_set.all.0.guest_profile.allergens|join:", " }}</td>
                                    <td class="text-center fw-medium">Table x</td>
                                </tr>
                                {% endfor %}
                            </tbody>

                            </table>
                        </div>
                    </div>
                </div>
        </div>
        <div class="col-lg-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title d-flex align-items-center gap-2">Attendance metrics<span><iconify-icon icon="solar:question-circle-bold" class="fs-7 d-flex text-muted" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="tooltip-success" data-bs-title="Locations"></iconify-icon></span>
              </h5>
              <span class="fs-11 mt-2 d-block text-nowrap mb-3">Total guests number: {{ event.guests.count }}</span>
              <div class="row">
                <div class="col-4">
                  <iconify-icon icon="solar:laptop-minimalistic-line-duotone" class="fs-7 d-flex text-primary"></iconify-icon>
                  <span class="fs-11 mt-2 d-block text-nowrap">Attended</span>
                  <h4 class="mb-0 mt-1">87%</h4>
                </div>
                <div class="col-4">
                  <iconify-icon icon="solar:smartphone-line-duotone" class="fs-7 d-flex text-secondary"></iconify-icon>
                  <span class="fs-11 mt-2 d-block text-nowrap">Didn't attend</span>
                  <h4 class="mb-0 mt-1">9.2%</h4>
                </div>
                <div class="col-4">
                  <iconify-icon icon="solar:tablet-line-duotone" class="fs-7 d-flex text-success"></iconify-icon>
                  <span class="fs-11 mt-2 d-block text-nowrap">Didn't confirm</span>
                  <h4 class="mb-0 mt-1">3.1%</h4>
                </div>
              </div>

              <div class="vstack gap-4 mt-7 pt-2">
                <div>
                  <div class="hstack justify-content-between">
                    <span class="fs-3 fw-medium">Attended</span>
                    <h6 class="fs-3 fw-medium text-dark lh-base mb-0">87%</h6>
                  </div>
                  <div class="progress mt-6" role="progressbar" aria-label="Warning example" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar bg-primary" style="width: 87%"></div>
                  </div>
                </div>

                <div>
                  <div class="hstack justify-content-between">
                    <span class="fs-3 fw-medium">Didn't attend</span>
                    <h6 class="fs-3 fw-medium text-dark lh-base mb-0">9.2%</h6>
                  </div>
                  <div class="progress mt-6" role="progressbar" aria-label="Warning example" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar bg-secondary" style="width: 9.2%"></div>
                  </div>
                </div>

                <div>
                  <div class="hstack justify-content-between">
                    <span class="fs-3 fw-medium">Didn't confirm</span>
                    <h6 class="fs-3 fw-medium text-dark lh-base mb-0">3.1%</h6>
                  </div>
                  <div class="progress mt-6" role="progressbar" aria-label="Warning example" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar bg-success" style="width: 3.1%"></div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
        
      </div>
    </div>
  </div>
</div>
{% endblock %}