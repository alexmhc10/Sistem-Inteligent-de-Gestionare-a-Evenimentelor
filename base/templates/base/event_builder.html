{% extends 'main.html' %}
{% load static %}

{% block content %}
    <div class="event_builder">
        <h3>Create a New Event</h3>
        
        {% if form2.errors %}
            <div class="alert alert-danger">
                <strong>Errors:</strong>
                <ul>
                    {% for field, errors in form2.errors.items %}
                        <li>{{ field }}: {{ errors|join:", " }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        <form id="eventForm" method="POST" action="">
            {% csrf_token %}
            
            <!-- Event Details -->
            <div class="form-step" id="step1">
                <label for="event_name">Event Name</label>
                <input type="text" id="event_name" name="event_name" placeholder="Enter event name" required>
                
                <label for="event_date">Event Date</label>
                <input type="date" id="event_date" name="event_date" required>
                
                <label for="event_time">Event Time</label>
                <input type="time" id="event_time" name="event_time" required>
                
                <label for="event_description">Event Description</label>
                <textarea id="event_description" name="event_description" placeholder="Add a short description" rows="4" required></textarea>

                <label for="location">Location</label>
                <select id="location" name="location" required>
                    {% for location in locations %}
                        <option value="{{ location.id }}">{{ location.name }}</option>
                    {% empty %}
                        <option value="">No locations available</option>
                    {% endfor %}
                </select>
                
                <label for="event_type">Event Type</label>
                <select id="event_type" name="event_type" required>
                    <option value="Wedding">Wedding</option>
                    <option value="Birthday">Birthday</option>
                    <option value="Banquet">Banquet</option>
                    <option value="Party">Party</option>
                    <option value="Adventist Gathering">Adventist Gathering</option>
                    <option value="Sabbath">Sabbath</option>
                    <option value="Church">Church</option>
                    <option value="Celebration">Celebration</option>
                </select>

                <label for="cost">Cost</label>
                <input type="number" id="cost" name="cost" placeholder="Estimated cost" min="0" required>
                
                <div class="form-step-buttons">
                    <button type="button" class="btn-next" onclick="nextStep(2)">Next</button>
                </div>
            </div>
            
            <!-- Guest List -->
            <div class="form-step" id="step2" style="display:none;">
                <h4>Guests</h4>
                <textarea id="guest_list" name="guest_list" placeholder="Enter guest names, separated by commas" rows="4"></textarea>
                
                <div class="form-step-buttons">
                    <button type="button" class="btn-prev" onclick="prevStep(1)">Back</button>
                    <button type="submit" class="btn-submit">Save Event</button>
                </div>
            </div>
        </form>
    </div>

    <script>
        function nextStep(step) {
            document.querySelectorAll('.form-step').forEach(function(stepDiv) {
                stepDiv.style.display = 'none';
            });
            document.getElementById('step' + step).style.display = 'block';
        }

        function prevStep(step) {
            document.querySelectorAll('.form-step').forEach(function(stepDiv) {
                stepDiv.style.display = 'none';
            });
            document.getElementById('step' + step).style.display = 'block';
        }
    </script>
{% endblock %}
